<?php if($_SERVER['REQUEST_METHOD']==='POST'){ $env="# Generated by NXI Installer\n"; foreach(['DB_NAME','DB_USER','DB_PASS','DB_HOST','APP_DOMAIN','BRAND_COLOR','BRAND_LABEL','XENDIT_PUBLIC_KEY','XENDIT_SECRET_KEY','APP_ENV','APP_DEBUG','APP_URL'] as $k){ $v=$_POST[$k]??''; $env.=$k.'='.$v."\n"; } file_put_contents(__DIR__.'/../.env',$env); file_put_contents(__DIR__.'/../config/config.php',"<?php\nreturn ".var_export(['brand'=>['domain'=>$_POST['APP_DOMAIN']??'ads.nxi.or.id','color'=>$_POST['BRAND_COLOR']??'#E8B923','label'=>$_POST['BRAND_LABEL']??'Ads by NXI'],'xendit'=>['public'=>$_POST['XENDIT_PUBLIC_KEY']??'','secret'=>$_POST['XENDIT_SECRET_KEY']??''],], true).";"); file_put_contents(__DIR__.'/../config/database.php',"<?php\nreturn ".var_export(['host'=>$_POST['DB_HOST']??'127.0.0.1','user'=>$_POST['DB_USER']??'','pass'=>$_POST['DB_PASS']??'','name'=>$_POST['DB_NAME']??''], true).";"); $db=require __DIR__.'/../config/database.php'; $m=@new mysqli($db['host'],$db['user'],$db['pass'],$db['name']); if($m->connect_errno) die('DB error: '.$m->connect_error); $sql=file_get_contents(__DIR__.'/setup.sql'); if(!$m->multi_query($sql)) die('SQL error: '.$m->error); while($m->more_results() && $m->next_result()){} echo "<p>âœ… Installer finished. <a href='/dashboard/register.php'>Create first account</a></p>"; exit; } $env=file_exists(__DIR__.'/../.env.example')?file_get_contents(__DIR__.'/../.env.example'):''; ?><!doctype html><html><head><meta charset='utf-8'><link rel='stylesheet' href='/public/assets/css/style.css'><title>Installer</title></head><body><div class='container'><div class='card'><h1>NXI Ads Installer</h1><form method='post'><h3>Database</h3><label>DB_HOST</label><input name='DB_HOST' value='127.0.0.1'><label>DB_USER</label><input name='DB_USER'><label>DB_PASS</label><input name='DB_PASS'><label>DB_NAME</label><input name='DB_NAME'><h3>Brand</h3><label>APP_DOMAIN</label><input name='APP_DOMAIN' value='ads.nxi.or.id'><label>BRAND_COLOR</label><input name='BRAND_COLOR' value='#E8B923'><label>BRAND_LABEL</label><input name='BRAND_LABEL' value='Ads by NXI'><h3>Xendit</h3><label>XENDIT_PUBLIC_KEY</label><input name='XENDIT_PUBLIC_KEY'><label>XENDIT_SECRET_KEY</label><input name='XENDIT_SECRET_KEY'><h3>App</h3><label>APP_ENV</label><input name='APP_ENV' value='production'><label>APP_DEBUG</label><input name='APP_DEBUG' value='false'><label>APP_URL</label><input name='APP_URL' value='https://ads.nxi.or.id'><button>Install</button></form></div></div></body></html>
